# 归一化和正则化

# 1.归一化

为了使所有输入数据落在一个范围内，避免一些不重要的信息导致过拟合。同时，它实际上是对梯度的惩罚，因为最后的损失值多了一个控制因素，在一定程度上能够减少梯度爆炸发生的可能性。


# 2.正则化

为了减少权重的复杂度，也是为了避免过拟合，使模型更具泛化性，所以引入了正则化。
  
正则化是在损失函数后面增加的一项，用来对损失函数中的某些参数作出限制。损失函数被称为 “经验风险”，而这个正则化的函数则被称为 “结构风险”。  

正则化有 L0范数、 L1范数 和 L2范数。

## 2.1 L0正则化

L0范数 求解的是非 0 权重的个数。这是不太好求解的，所以一般不用。

## 2.2 L1正则化

  
![$c = c_0 + \frac{𝞴}{n}\sum_w{|w|}$](http://ogemdlrap.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-10-09%20%E4%B8%8B%E5%8D%885.21.48.png)



其中，$c_0$ 损失函数，表示“经验风险”，它来源于整个样本（预测值）和标签（真实值）的差距；

  
  ![$\frac{𝞴}{n}\sum_w{|w|}$](http://ogemdlrap.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-10-09%20%E4%B8%8B%E5%8D%885.22.03.png)

损失函数，表示“结构风险”，它将所有的 w 权值求和，然后除以样本数n，再根据一个系数来决定我们有多重视“结构风险”。

![屏幕快照 2018-10-09 下午5.34.03](http://ogemdlrap.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-10-09%20%E4%B8%8B%E5%8D%885.34.03.png)

图中就是一个包含了正则化的损失函数，在两个函数的交点出有最优解，我们的目标就是找到这个点。系数 𝞴 越大，则正方形会越大，表示越需要重视结构风险。 


## 2.3 L2正则化

![$c = c_0 + \frac{𝞴}{n}\sum_w{w^2}$](http://ogemdlrap.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-10-09%20%E4%B8%8B%E5%8D%885.44.07.png)

这是L2范数公式，就是将所有权重 w 都平方后，在加和，然后除以权重数量，再乘以一个系数。  

![屏幕快照 2018-10-09 下午5.47.44](http://ogemdlrap.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-10-09%20%E4%B8%8B%E5%8D%885.47.44.png)

